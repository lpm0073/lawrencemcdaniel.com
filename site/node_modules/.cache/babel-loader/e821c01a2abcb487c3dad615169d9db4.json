{"ast":null,"code":"var _jsxFileName = \"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/src/components/logocube/Component.js\";\n\n/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */\nimport React, { Component } from 'react';\nimport { wpGetFeaturedImage } from '../../shared/wpGetFeaturedImage';\nimport './styles.css';\nimport Loading from '../Loading';\n\nconst LogoDiv = props => {\n  const clsId = \"d3-side \" + props.side;\n  const divId = \"cube-\" + props.side;\n  const divStyle = {\n    \"background-image\": props.url\n  };\n  console.log(\"LogoDiv()\", props.side, props.url);\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: clsId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 36\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: divId,\n    className: \"logo\",\n    style: Object.assign(divStyle),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 17\n    }\n  }))));\n};\n\nclass LogoCube extends Component {\n  constructor(props) {\n    super(props);\n    /*\n        Note: one ugly side effect of the randomness in choosing which side to update, and\n        the time at which to update is that, sometimes, the same panel gets chosen very quickly\n        which leads to jerky-looking behavior.\n         To prevent this we keep track of how long each logo has been on a given cube side.\n        the repaint() method will only repaint a side if that side has in-state for at least \n        X milliseconds.\n     */\n\n    var d = new Date();\n    d.setSeconds(d.getSeconds() - 2);\n    const logos = this.props.logos.items.map((post, indx) => {\n      return wpGetFeaturedImage(post, null);\n    });\n    this.state = {\n      logos: logos,\n      timeout: null,\n      cubeTop: d,\n      cubeBottom: d,\n      cubeLeft: d,\n      cubeRight: d,\n      cubeFront: d,\n      cubeBack: d,\n      cubeTopBackgroundUrl: null,\n      cubeBottomBackgroundUrl: null,\n      cubeLeftBackgroundUrl: null,\n      cubeRightBackgroundUrl: null,\n      cubeFrontBackgroundUrl: null,\n      cubeBackBackgroundUrl: null\n    };\n    this.resetElapsedTime = this.resetElapsedTime.bind(this);\n    this.getElapsedTime = this.getElapsedTime.bind(this);\n    this.getBackgroundUrl = this.getBackgroundUrl.bind(this);\n    this.setBackgroundUrl = this.setBackgroundUrl.bind(this);\n    this.getRandomSide = this.getRandomSide.bind(this);\n    this.getRandomLogo = this.getRandomLogo.bind(this);\n    this.logos = this.logos.bind(this);\n    this.shuffleArray = this.shuffleArray.bind(this);\n    this.repaint = this.repaint.bind(this);\n  }\n\n  componentDidMount() {\n    /*\n        Note: componentDidMount() gets called a half dozen times bc the Home component\n        which instantiates this component itself mounts and unmounts multiple times.\n         we therefore have to keep track of any repaint() threads that we invoke so that \n        we can kill them if necessary.\n     */\n    var self = this;\n\n    if (!this.props.logos.isLoading) {\n      var myTimeout = setTimeout(function () {\n        self.repaint();\n      }, 1000);\n    }\n\n    this.setState({\n      timeout: myTimeout\n    });\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.state.timeout);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"logoprop\",\n      className: \"d3-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }\n    }, this.props.logos.isLoading ? /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-cube\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(LogoDiv, {\n      side: \"top\",\n      url: this.getBackgroundUrl(\"top\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(LogoDiv, {\n      side: \"bottom\",\n      url: this.getBackgroundUrl(\"bottom\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(LogoDiv, {\n      side: \"front\",\n      url: this.getBackgroundUrl(\"front\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(LogoDiv, {\n      side: \"back\",\n      url: this.getBackgroundUrl(\"back\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(LogoDiv, {\n      side: \"right\",\n      url: this.getBackgroundUrl(\"right\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(LogoDiv, {\n      side: \"left\",\n      url: this.getBackgroundUrl(\"left\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }\n    })));\n  }\n\n  repaint() {\n    var self = this;\n    setTimeout(function () {\n      const side = self.getRandomSide();\n      const logo = self.getRandomLogo(self.state.logos);\n\n      if (self.getElapsedTime(side) > 3000) {\n        self.setBackgroundUrl(side, logo);\n      }\n\n      self.repaint();\n    }, 1000 * Math.random());\n  }\n\n  getRandomLogo(logos) {\n    const logo = logos[Math.floor(Math.random() * logos.length)];\n\n    if (logo === this.state.cubeTopBackgroundUrl) {\n      return null;\n    }\n\n    if (logo === this.state.cubeBottomBackgroundUrl) {\n      return null;\n    }\n\n    if (logo === this.state.cubeBackBackgroundUrl) {\n      return null;\n    }\n\n    if (logo === this.state.cubeFrontBackgroundUrl) {\n      return null;\n    }\n\n    if (logo === this.state.cubeLeftBackgroundUrl) {\n      return null;\n    }\n\n    if (logo === this.state.cubeRightBackgroundUrl) {\n      return null;\n    }\n\n    return logo;\n  }\n\n  getRandomSide() {\n    const side = Math.floor(Math.random() * 6);\n\n    switch (side) {\n      case 1:\n        return \"top\";\n\n      case 2:\n        return \"bottom\";\n\n      case 3:\n        return \"left\";\n\n      case 4:\n        return \"right\";\n\n      case 5:\n        return \"front\";\n\n      case 6:\n        return \"back\";\n    }\n  }\n\n  getBackgroundUrl(side) {\n    console.log(\"getBackgroundUrl\", side);\n\n    switch (side) {\n      case \"top\":\n        return this.state.cubeTopBackgroundUrl;\n\n      case \"bottom\":\n        return this.state.cubeBottomBackgroundUrl;\n\n      case \"left\":\n        return this.state.cubeLeftBackgroundUrl;\n\n      case \"right\":\n        return this.state.cubeRightBackgroundUrl;\n\n      case \"front\":\n        return this.state.cubeFrontBackgroundUrl;\n\n      case \"back\":\n        return this.state.cubeBackBackgroundUrl;\n    }\n  }\n\n  setBackgroundUrl(side, url) {\n    console.log(\"setBackgroundUrl()\", side, url);\n\n    switch (side) {\n      case \"cube-top\":\n        this.setState({\n          cubeTopBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-bottom\":\n        this.setState({\n          cubeBottomBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-left\":\n        this.setState({\n          cubeLeftBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-right\":\n        this.setState({\n          cubeRightBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-front\":\n        this.setState({\n          cubeFrontBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-back\":\n        this.setState({\n          cubeBackBackgroundUrl: url\n        });\n        break;\n    }\n\n    this.resetElapsedTime(side);\n  }\n\n  resetElapsedTime(side) {\n    const d = new Date();\n\n    switch (side) {\n      case \"cube-top\":\n        this.setState({\n          cubeTop: d\n        });\n        break;\n\n      case \"cube-bottom\":\n        this.setState({\n          cubeBottom: d\n        });\n        break;\n\n      case \"cube-left\":\n        this.setState({\n          cubeLeft: d\n        });\n        break;\n\n      case \"cube-right\":\n        this.setState({\n          cubeRight: d\n        });\n        break;\n\n      case \"cube-front\":\n        this.setState({\n          cubeFront: d\n        });\n        break;\n\n      case \"cube-back\":\n        this.setState({\n          cubeBack: d\n        });\n        break;\n    }\n  }\n\n  getElapsedTime(side) {\n    const d = new Date();\n\n    switch (side) {\n      case \"cube-top\":\n        return d - this.state.cubeTop;\n\n      case \"cube-bottom\":\n        return d - this.state.cubeBottom;\n\n      case \"cube-left\":\n        return d - this.state.cubeLeft;\n\n      case \"cube-right\":\n        return d - this.state.cubeRight;\n\n      case \"cube-front\":\n        return d - this.state.cubeFront;\n\n      case \"cube-back\":\n        return d - this.state.cubeBack;\n    }\n  }\n\n  logos() {\n    var self = this;\n    return self.props.logos.items;\n  }\n\n  shuffleArray(array) {\n    let i = array.length - 1;\n\n    for (; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      const temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n    }\n\n    return array;\n  }\n\n}\n\nexport default LogoCube;","map":{"version":3,"sources":["/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/src/components/logocube/Component.js"],"names":["React","Component","wpGetFeaturedImage","Loading","LogoDiv","props","clsId","side","divId","divStyle","url","console","log","Object","assign","LogoCube","constructor","d","Date","setSeconds","getSeconds","logos","items","map","post","indx","state","timeout","cubeTop","cubeBottom","cubeLeft","cubeRight","cubeFront","cubeBack","cubeTopBackgroundUrl","cubeBottomBackgroundUrl","cubeLeftBackgroundUrl","cubeRightBackgroundUrl","cubeFrontBackgroundUrl","cubeBackBackgroundUrl","resetElapsedTime","bind","getElapsedTime","getBackgroundUrl","setBackgroundUrl","getRandomSide","getRandomLogo","shuffleArray","repaint","componentDidMount","self","isLoading","myTimeout","setTimeout","setState","componentWillUnmount","clearTimeout","render","logo","Math","random","floor","length","array","i","j","temp"],"mappings":"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","sourcesContent":["/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */\nimport React, { Component } from 'react';\nimport { wpGetFeaturedImage } from '../../shared/wpGetFeaturedImage';\nimport './styles.css';\nimport Loading from '../Loading';\n\nconst LogoDiv = (props) => {\n\n    const clsId = \"d3-side \" + props.side;\n    const divId = \"cube-\" + props.side;\n    const divStyle = {\n        \"background-image\": props.url\n      }\n    console.log(\"LogoDiv()\", props.side, props.url);\n    return(\n        <React.Fragment>\n            <div className={clsId}><div>\n                <div id={divId} \n                     className=\"logo\" \n                     style={Object.assign(divStyle)}>\n                </div>\n            </div></div>\n\n        </React.Fragment>\n\n    );\n}\nclass LogoCube extends Component {\n\n    constructor(props) {\n        super(props);\n\n        /*\n            Note: one ugly side effect of the randomness in choosing which side to update, and\n            the time at which to update is that, sometimes, the same panel gets chosen very quickly\n            which leads to jerky-looking behavior.\n\n            To prevent this we keep track of how long each logo has been on a given cube side.\n            the repaint() method will only repaint a side if that side has in-state for at least \n            X milliseconds.\n         */\n        var d = new Date();\n        d.setSeconds(d.getSeconds() - 2);\n\n        const logos =  this.props.logos.items.map((post, indx) => {\n            return wpGetFeaturedImage(post, null);\n        });\n\n        this.state = {\n            logos: logos,\n            timeout: null,\n            cubeTop: d,\n            cubeBottom: d,\n            cubeLeft: d,\n            cubeRight: d,\n            cubeFront: d,\n            cubeBack: d,\n\n            cubeTopBackgroundUrl: null,\n            cubeBottomBackgroundUrl: null,\n            cubeLeftBackgroundUrl: null,\n            cubeRightBackgroundUrl: null,\n            cubeFrontBackgroundUrl: null,\n            cubeBackBackgroundUrl: null\n          };\n\n        this.resetElapsedTime = this.resetElapsedTime.bind(this);\n        this.getElapsedTime = this.getElapsedTime.bind(this);\n        this.getBackgroundUrl = this.getBackgroundUrl.bind(this);\n        this.setBackgroundUrl = this.setBackgroundUrl.bind(this);\n        this.getRandomSide = this.getRandomSide.bind(this);\n        this.getRandomLogo = this.getRandomLogo.bind(this);\n    \n        this.logos = this.logos.bind(this);\n        this.shuffleArray = this.shuffleArray.bind(this);\n        this.repaint = this.repaint.bind(this);\n        }\n\n\n\n    componentDidMount() {\n        /*\n            Note: componentDidMount() gets called a half dozen times bc the Home component\n            which instantiates this component itself mounts and unmounts multiple times.\n\n            we therefore have to keep track of any repaint() threads that we invoke so that \n            we can kill them if necessary.\n         */\n        var self = this;\n        if (!this.props.logos.isLoading) {\n            var myTimeout = setTimeout(function() {\n                self.repaint();\n            }, 1000);    \n        }\n        this.setState({timeout: myTimeout});\n\n    }\n\n    componentWillUnmount() {\n        clearTimeout(this.state.timeout);        \n    }\n    \n    render() {\n\n        return(\n            <div id=\"logoprop\" className=\"d3-container\">\n            {this.props.logos.isLoading ? (\n                <Loading />\n              ) : (\n                <div className=\"d3-cube\">\n                    <LogoDiv side={\"top\"} url={this.getBackgroundUrl(\"top\")} />\n                    <LogoDiv side={\"bottom\"} url={this.getBackgroundUrl(\"bottom\")} />\n                    <LogoDiv side={\"front\"} url={this.getBackgroundUrl(\"front\")} />\n                    <LogoDiv side={\"back\"} url={this.getBackgroundUrl(\"back\")} />\n                    <LogoDiv side={\"right\"} url={this.getBackgroundUrl(\"right\")} />\n                    <LogoDiv side={\"left\"} url={this.getBackgroundUrl(\"left\")} />\n                </div>\n              )}\n            </div>\n        );\n    }\n\n    repaint() {\n        var self = this;\n        \n        setTimeout(function() {\n            const side = self.getRandomSide();\n            const logo = self.getRandomLogo(self.state.logos);\n            if (self.getElapsedTime(side) > 3000) {\n                self.setBackgroundUrl(side, logo);\n            }\n            self.repaint();\n        }, 1000 * Math.random());   \n      \n    }\n\n    getRandomLogo(logos) {\n        const logo = logos[Math.floor(Math.random() * logos.length)];\n\n        if (logo === this.state.cubeTopBackgroundUrl) {return null}\n        if (logo === this.state.cubeBottomBackgroundUrl) {return null}\n        if (logo === this.state.cubeBackBackgroundUrl) {return null}\n        if (logo === this.state.cubeFrontBackgroundUrl) {return null}\n        if (logo === this.state.cubeLeftBackgroundUrl) {return null}\n        if (logo === this.state.cubeRightBackgroundUrl) {return null}\n\n        return logo;\n    }\n\n    \n    getRandomSide() {\n\n        const side = Math.floor(Math.random() * 6);\n        switch(side) {\n            case 1: return \"top\";\n            case 2: return \"bottom\";\n            case 3: return \"left\";\n            case 4: return \"right\";\n            case 5: return \"front\";\n            case 6: return \"back\";\n        }\n    \n    }\n    \n    getBackgroundUrl(side) {\n        console.log(\"getBackgroundUrl\", side);\n        switch(side) {\n            case \"top\": return this.state.cubeTopBackgroundUrl;\n            case \"bottom\": return this.state.cubeBottomBackgroundUrl;\n            case \"left\": return this.state.cubeLeftBackgroundUrl;\n            case \"right\": return this.state.cubeRightBackgroundUrl;\n            case \"front\": return this.state.cubeFrontBackgroundUrl;\n            case \"back\": return this.state.cubeBackBackgroundUrl;\n        }\n\n    }\n\n    setBackgroundUrl(side, url) {\n        console.log(\"setBackgroundUrl()\", side, url);\n\n        switch(side) {\n            case \"cube-top\":\n                this.setState({cubeTopBackgroundUrl: url});\n                break;\n            case \"cube-bottom\":\n                this.setState({cubeBottomBackgroundUrl: url});\n                break;\n            case \"cube-left\":\n                this.setState({cubeLeftBackgroundUrl: url});\n                break;\n            case \"cube-right\":\n                this.setState({cubeRightBackgroundUrl: url});\n                break;\n            case \"cube-front\":\n                this.setState({cubeFrontBackgroundUrl: url});\n                break;\n            case \"cube-back\":\n                this.setState({cubeBackBackgroundUrl: url});\n                break;\n        }\n        this.resetElapsedTime(side);\n\n    }\n\n    resetElapsedTime(side) {\n        const d = new Date();\n        switch(side) {\n            case \"cube-top\":\n                this.setState({cubeTop: d});\n                break;\n            case \"cube-bottom\":\n                this.setState({cubeBottom: d});\n                break;\n            case \"cube-left\":\n                this.setState({cubeLeft: d});\n                break;\n            case \"cube-right\":\n                this.setState({cubeRight: d});\n                break;\n            case \"cube-front\":\n                this.setState({cubeFront: d});\n                break;\n            case \"cube-back\":\n                this.setState({cubeBack: d});\n                break;\n        }        \n    }\n\n    getElapsedTime(side) {\n        const d = new Date();\n        switch(side) {\n            case \"cube-top\": return d - this.state.cubeTop;\n            case \"cube-bottom\": return d - this.state.cubeBottom;\n            case \"cube-left\": return d - this.state.cubeLeft;\n            case \"cube-right\": return d - this.state.cubeRight;\n            case \"cube-front\": return d - this.state.cubeFront;\n            case \"cube-back\": return d - this.state.cubeBack;\n        }\n    }\n\n    logos() {\n        var self = this;\n        return self.props.logos.items;\n    }\n\n    shuffleArray(array) {\n        let i = array.length - 1;\n        for (; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            const temp = array[i];\n            array[i] = array[j];\n            array[j] = temp;\n        }\n        return array;\n    }\n\n\n      \n}\n\nexport default LogoCube;\n"]},"metadata":{},"sourceType":"module"}