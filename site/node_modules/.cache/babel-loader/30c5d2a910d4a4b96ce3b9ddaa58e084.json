{"ast":null,"code":"import _classCallCheck from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */import React,{Component}from'react';import{wpGetFeaturedImage}from'../../shared/wpGetFeaturedImage';import'./styles.css';import Loading from'../Loading';var LogoCube=/*#__PURE__*/function(_Component){_inherits(LogoCube,_Component);var _super=_createSuper(LogoCube);function LogoCube(props){var _this;_classCallCheck(this,LogoCube);_this=_super.call(this,props);/*\n            Note: one ugly side effect of the randomness in choosing which side to update, and\n            the time at which to update is that, sometimes, the same panel gets chosen very quickly\n            which leads to jerky-looking behavior.\n\n            To prevent this we keep track of how long each logo has been on a given cube side.\n            the repaint() method will only repaint a side if that side has been in the same state \n            for at least X milliseconds.\n         */var d=new Date();d.setSeconds(d.getSeconds()-2);var logos=_this.props.logos.items.map(function(post,indx){return wpGetFeaturedImage(post,null);});var featured_logos=_this.props.logos.items.filter(function(post,indx){for(var i=0;i<post.categories.length;i++){if(post.categories[i]===48){/* featured technology */return true;}}return false;}).map(function(featuredPost,indx){return wpGetFeaturedImage(featuredPost,null);});_this.state={logos:logos,featured_logos:featured_logos,repaintDelay:null,logosDelay:null,shouldUpdate:false,cubeTop:d,cubeBottom:d,cubeLeft:d,cubeRight:d,cubeFront:d,cubeBack:d,cubeTopBackgroundUrl:null,cubeBottomBackgroundUrl:null,cubeLeftBackgroundUrl:null,cubeRightBackgroundUrl:null,cubeFrontBackgroundUrl:null,cubeBackBackgroundUrl:null};_this.resetElapsedTime=_this.resetElapsedTime.bind(_assertThisInitialized(_this));_this.getElapsedTime=_this.getElapsedTime.bind(_assertThisInitialized(_this));_this.getBackgroundUrl=_this.getBackgroundUrl.bind(_assertThisInitialized(_this));_this.setBackgroundUrl=_this.setBackgroundUrl.bind(_assertThisInitialized(_this));_this.getRandomSide=_this.getRandomSide.bind(_assertThisInitialized(_this));_this.getRandomLogo=_this.getRandomLogo.bind(_assertThisInitialized(_this));_this.getSerializedLogo=_this.getSerializedLogo.bind(_assertThisInitialized(_this));_this.isLogoCollision=_this.isLogoCollision.bind(_assertThisInitialized(_this));_this.repaint=_this.repaint.bind(_assertThisInitialized(_this));return _this;}_createClass(LogoCube,[{key:\"componentDidMount\",value:function componentDidMount(){/*\n            Note: componentDidMount() gets called a half dozen times bc the Home component\n            which instantiates this component itself mounts and unmounts multiple times.\n\n            we therefore delay the first repaint for a while. however\n            we also have to keep track of the repaint() threads that we invoke so that \n            we can kill them in cases where the component mounts and then quickly unmounts.\n         */var self=this;if(!this.props.logos.isLoading){/* enable render() 1 second after logos are loaded */var myTimeout=setTimeout(function(){self.setState({shouldUpdate:true});},1000);/*  the cube is initialized with the most impactful logos, so    \n                wait a while before we begin shuffling the logos. Then\n                kick off an infinite loop of repaint() */myTimeout=setTimeout(function(){self.repaint();},5000);this.setState({repaintDelay:myTimeout});/* wait for animations to complete. */myTimeout=setTimeout(function(){self.setBackgroundUrl(\"left\",self.getSerializedLogo(self.state.featured_logos,0));self.setBackgroundUrl(\"right\",self.getSerializedLogo(self.state.featured_logos,1));self.setBackgroundUrl(\"top\",self.getSerializedLogo(self.state.featured_logos,2));self.setBackgroundUrl(\"bottom\",self.getSerializedLogo(self.state.featured_logos,3));self.setBackgroundUrl(\"front\",self.getSerializedLogo(self.state.featured_logos,4));self.setBackgroundUrl(\"back\",self.getSerializedLogo(self.state.featured_logos,5));},1500);self.setState({logosDelay:myTimeout});}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){/* kill any pending repaint() invocation from componentDidMount(). */clearTimeout(this.state.repaintDelay);clearTimeout(this.state.logosDelay);}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){return this.state.shouldUpdate;}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{key:\"logo-cube\",className:\"d3-container mt-0\"},this.props.logos.isLoading?/*#__PURE__*/React.createElement(\"div\",{className:\"mt-5 pt-5\"},/*#__PURE__*/React.createElement(Loading,null)):/*#__PURE__*/React.createElement(\"div\",{className:\"d3-cube mt-5\"},/*#__PURE__*/React.createElement(CubeSide,{side:\"top\",url:this.getBackgroundUrl(\"top\"),classes:\"fade-in\"}),/*#__PURE__*/React.createElement(CubeSide,{side:\"bottom\",url:this.getBackgroundUrl(\"bottom\"),classes:\"fade-in\"}),/*#__PURE__*/React.createElement(CubeSide,{side:\"front\",url:this.getBackgroundUrl(\"front\"),classes:\"grow-side\"}),/*#__PURE__*/React.createElement(CubeSide,{side:\"back\",url:this.getBackgroundUrl(\"back\"),classes:\"grow-side\"}),/*#__PURE__*/React.createElement(CubeSide,{side:\"right\",url:this.getBackgroundUrl(\"right\"),classes:\"grow-side\"}),/*#__PURE__*/React.createElement(CubeSide,{side:\"left\",url:this.getBackgroundUrl(\"left\"),classes:\"grow-side\"})));}},{key:\"repaint\",value:function repaint(){var self=this;var side=self.getRandomSide();var logos=side===\"front\"?self.state.featured_logos:self.state.logos;var logo=self.getRandomLogo(logos);var elapsed=self.getElapsedTime(side);if(side!=null&&elapsed>3000){self.setBackgroundUrl(side,logo);}setTimeout(function(){self.repaint();},1000*Math.random());}},{key:\"getBackgroundUrl\",value:function getBackgroundUrl(side){var retval;switch(side){case\"top\":retval=this.state.cubeTopBackgroundUrl;break;case\"bottom\":retval=this.state.cubeBottomBackgroundUrl;break;case\"left\":retval=this.state.cubeLeftBackgroundUrl;break;case\"right\":retval=this.state.cubeRightBackgroundUrl;break;case\"front\":retval=this.state.cubeFrontBackgroundUrl;break;case\"back\":retval=this.state.cubeBackBackgroundUrl;break;default:retval=null;break;}return retval;}},{key:\"setBackgroundUrl\",value:function setBackgroundUrl(side,url){var _this2=this;var state;switch(side){case\"top\":state={cubeTopBackgroundUrl:url};break;case\"bottom\":state={cubeBottomBackgroundUrl:url};break;case\"left\":state={cubeLeftBackgroundUrl:url};break;case\"right\":state={cubeRightBackgroundUrl:url};break;case\"front\":state={cubeFrontBackgroundUrl:url};break;case\"back\":state={cubeBackBackgroundUrl:url};break;default:state={};break;}this.setState(state,function(){_this2.resetElapsedTime(side);});}},{key:\"resetElapsedTime\",value:function resetElapsedTime(side){var d=new Date();var state;switch(side){case\"top\":state={cubeTop:d};break;case\"bottom\":state={cubeBottom:d};break;case\"left\":state={cubeLeft:d};break;case\"right\":state={cubeRight:d};break;case\"front\":state={cubeFront:d};break;case\"back\":state={cubeBack:d};break;default:state={};break;}this.setState(state);}},{key:\"getElapsedTime\",value:function getElapsedTime(side){var d=new Date();switch(side){case\"top\":return d-this.state.cubeTop;case\"bottom\":return d-this.state.cubeBottom;case\"left\":return d-this.state.cubeLeft;case\"right\":return d-this.state.cubeRight;case\"front\":return d-this.state.cubeFront;case\"back\":return d-this.state.cubeBack;default:return 0;}}},{key:\"getSerializedLogo\",value:function getSerializedLogo(logos,i){if(i<logos.length){return logos[i];}}},{key:\"isLogoCollision\",value:function isLogoCollision(logo){switch(logo){case this.state.cubeTopBackgroundUrl:case this.state.cubeBottomBackgroundUrl:case this.state.cubeBackBackgroundUrl:case this.state.cubeFrontBackgroundUrl:case this.state.cubeLeftBackgroundUrl:case this.state.cubeRightBackgroundUrl:return true;default:return false;}}},{key:\"getRandomLogo\",value:function getRandomLogo(logos){var logo,i=0;do{logo=logos[Math.floor(Math.random()*logos.length)];i++;}while(this.isLogoCollision(logo)&&i<=logos.length);return logo;}},{key:\"getRandomSide\",value:function getRandomSide(){var side=Math.floor(Math.random()*6);switch(side){case 0:return\"top\";case 1:return\"bottom\";case 2:return\"left\";case 3:return\"right\";case 4:return\"front\";case 5:return\"back\";default:return null;}}}]);return LogoCube;}(Component);export default LogoCube;var CubeSide=function CubeSide(props){var clsId=\"d3-side \"+props.side+\" \"+props.classes;var divId=\"cube-\"+props.side+\"-logo\";var divStyle={backgroundImage:\"url('\"+props.url+\"')\"};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{key:divId,className:clsId},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"logo\",style:divStyle}))));};","map":{"version":3,"sources":["/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/src/components/logoCube/Component.js"],"names":["React","Component","wpGetFeaturedImage","Loading","LogoCube","props","d","Date","setSeconds","getSeconds","logos","items","map","post","indx","featured_logos","filter","i","categories","length","featuredPost","state","repaintDelay","logosDelay","shouldUpdate","cubeTop","cubeBottom","cubeLeft","cubeRight","cubeFront","cubeBack","cubeTopBackgroundUrl","cubeBottomBackgroundUrl","cubeLeftBackgroundUrl","cubeRightBackgroundUrl","cubeFrontBackgroundUrl","cubeBackBackgroundUrl","resetElapsedTime","bind","getElapsedTime","getBackgroundUrl","setBackgroundUrl","getRandomSide","getRandomLogo","getSerializedLogo","isLogoCollision","repaint","self","isLoading","myTimeout","setTimeout","setState","clearTimeout","nextProps","nextState","side","logo","elapsed","Math","random","retval","url","floor","CubeSide","clsId","classes","divId","divStyle","backgroundImage"],"mappings":"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","sourcesContent":["/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */\nimport React, { Component } from 'react';\nimport { wpGetFeaturedImage } from '../../shared/wpGetFeaturedImage';\nimport './styles.css';\nimport Loading from '../Loading';\n\n\nclass LogoCube extends Component {\n\n    constructor(props) {\n        super(props);\n\n        /*\n            Note: one ugly side effect of the randomness in choosing which side to update, and\n            the time at which to update is that, sometimes, the same panel gets chosen very quickly\n            which leads to jerky-looking behavior.\n\n            To prevent this we keep track of how long each logo has been on a given cube side.\n            the repaint() method will only repaint a side if that side has been in the same state \n            for at least X milliseconds.\n         */\n        var d = new Date();\n        d.setSeconds(d.getSeconds() - 2);\n\n        const logos =  this.props.logos.items.map((post, indx) => {\n            return wpGetFeaturedImage(post, null);\n        });\n\n        const featured_logos =  this.props.logos.items.filter((post, indx) => {\n            for (var i=0 ; i < post.categories.length ; i++) {\n                if (post.categories[i] === 48) {  /* featured technology */\n                    return true;\n                }\n            }\n            return false;\n        }).map((featuredPost, indx) => {\n            return wpGetFeaturedImage(featuredPost, null);\n        });\n\n        this.state = {\n            logos: logos,\n            featured_logos: featured_logos,\n            repaintDelay: null,\n            logosDelay: null,\n            shouldUpdate: false,\n            cubeTop: d,\n            cubeBottom: d,\n            cubeLeft: d,\n            cubeRight: d,\n            cubeFront: d,\n            cubeBack: d,\n\n            cubeTopBackgroundUrl: null,\n            cubeBottomBackgroundUrl: null,\n            cubeLeftBackgroundUrl: null,\n            cubeRightBackgroundUrl: null,\n            cubeFrontBackgroundUrl: null,\n            cubeBackBackgroundUrl: null\n          };\n\n        this.resetElapsedTime = this.resetElapsedTime.bind(this);\n        this.getElapsedTime = this.getElapsedTime.bind(this);\n        this.getBackgroundUrl = this.getBackgroundUrl.bind(this);\n        this.setBackgroundUrl = this.setBackgroundUrl.bind(this);\n        this.getRandomSide = this.getRandomSide.bind(this);\n        this.getRandomLogo = this.getRandomLogo.bind(this);\n        this.getSerializedLogo = this.getSerializedLogo.bind(this);\n        this.isLogoCollision = this.isLogoCollision.bind(this);\n    \n        this.repaint = this.repaint.bind(this);\n        }\n\n\n    componentDidMount() {\n        /*\n            Note: componentDidMount() gets called a half dozen times bc the Home component\n            which instantiates this component itself mounts and unmounts multiple times.\n\n            we therefore delay the first repaint for a while. however\n            we also have to keep track of the repaint() threads that we invoke so that \n            we can kill them in cases where the component mounts and then quickly unmounts.\n         */\n        var self = this;\n        if (!this.props.logos.isLoading) {\n\n            /* enable render() 1 second after logos are loaded */\n            var myTimeout = setTimeout(function() {\n                self.setState({shouldUpdate: true});\n            }, 1000);    \n\n            /*  the cube is initialized with the most impactful logos, so    \n                wait a while before we begin shuffling the logos. Then\n                kick off an infinite loop of repaint() */\n            myTimeout = setTimeout(function() {\n                self.repaint();\n            }, 5000);    \n            this.setState({repaintDelay: myTimeout});\n\n            /* wait for animations to complete. */\n            myTimeout = setTimeout(function() {\n                self.setBackgroundUrl(\"left\", self.getSerializedLogo(self.state.featured_logos, 0));                \n                self.setBackgroundUrl(\"right\", self.getSerializedLogo(self.state.featured_logos, 1));                \n                self.setBackgroundUrl(\"top\", self.getSerializedLogo(self.state.featured_logos, 2));\n                self.setBackgroundUrl(\"bottom\", self.getSerializedLogo(self.state.featured_logos, 3));                \n                self.setBackgroundUrl(\"front\", self.getSerializedLogo(self.state.featured_logos, 4));                \n                self.setBackgroundUrl(\"back\", self.getSerializedLogo(self.state.featured_logos, 5));\n                }, 1500);    \n                self.setState({logosDelay: myTimeout});\n        }\n\n    }\n\n    componentWillUnmount() {\n        /* kill any pending repaint() invocation from componentDidMount(). */\n        clearTimeout(this.state.repaintDelay);\n        clearTimeout(this.state.logosDelay);\n    }\n    \n    shouldComponentUpdate(nextProps, nextState) {\n        return this.state.shouldUpdate;\n    }\n\n    render() {\n\n        return(\n            <div key=\"logo-cube\" className=\"d3-container mt-0\">\n            {this.props.logos.isLoading ? (\n                <div className=\"mt-5 pt-5\">\n                    <Loading />\n                </div>\n              ) : (\n                <div className=\"d3-cube mt-5\">\n                    <CubeSide side=\"top\" url={this.getBackgroundUrl(\"top\")} classes=\"fade-in\" />\n                    <CubeSide side=\"bottom\" url={this.getBackgroundUrl(\"bottom\")} classes=\"fade-in\" />\n                    <CubeSide side=\"front\" url={this.getBackgroundUrl(\"front\")} classes=\"grow-side\"/>\n                    <CubeSide side=\"back\" url={this.getBackgroundUrl(\"back\")} classes=\"grow-side\" />\n                    <CubeSide side=\"right\" url={this.getBackgroundUrl(\"right\")} classes=\"grow-side\" />\n                    <CubeSide side=\"left\" url={this.getBackgroundUrl(\"left\")} classes=\"grow-side\" />\n                </div>\n              )}\n            </div>\n        );\n    }\n\n    repaint() {\n        var self = this;\n\n        const side = self.getRandomSide();\n        const logos = (side === \"front\") ? self.state.featured_logos: self.state.logos;\n        const logo = self.getRandomLogo(logos);\n        const elapsed = self.getElapsedTime(side);\n        if (side != null && elapsed > 3000) {\n            self.setBackgroundUrl(side, logo);\n        }\n    \n        setTimeout(function() {\n            self.repaint();\n        }, 1000 * Math.random());   \n      \n    }\n\n\n    getBackgroundUrl(side) {\n        let retval;\n        switch(side) {\n            case \"top\": retval = this.state.cubeTopBackgroundUrl; break;\n            case \"bottom\": retval =  this.state.cubeBottomBackgroundUrl; break;\n            case \"left\": retval =  this.state.cubeLeftBackgroundUrl; break;\n            case \"right\": retval =  this.state.cubeRightBackgroundUrl; break;\n            case \"front\": retval =  this.state.cubeFrontBackgroundUrl; break;\n            case \"back\": retval =  this.state.cubeBackBackgroundUrl; break;\n            default: retval = null; break;\n        }\n        return retval;\n    }\n\n    setBackgroundUrl(side, url) {\n\n        let state;\n        switch(side) {\n            case \"top\": state = {cubeTopBackgroundUrl: url}; break;\n            case \"bottom\": state = {cubeBottomBackgroundUrl: url}; break;\n            case \"left\": state = {cubeLeftBackgroundUrl: url}; break;\n            case \"right\": state = {cubeRightBackgroundUrl: url}; break;\n            case \"front\": state = {cubeFrontBackgroundUrl: url}; break;\n            case \"back\": state = {cubeBackBackgroundUrl: url}; break;\n            default: state = {}; break;\n        }\n        this.setState(state, () => {\n            this.resetElapsedTime(side);\n        });\n\n    }\n\n    resetElapsedTime(side) {\n        const d = new Date();\n        let state;\n        switch(side) {\n            case \"top\": state = {cubeTop: d}; break;\n            case \"bottom\": state = {cubeBottom: d}; break;\n            case \"left\":state = {cubeLeft: d}; break;\n            case \"right\": state = {cubeRight: d}; break;\n            case \"front\": state = {cubeFront: d}; break;\n            case \"back\": state = {cubeBack: d}; break;\n            default: state = {}; break;\n        }\n        this.setState(state);\n\n    }\n\n    getElapsedTime(side) {\n        const d = new Date();\n        switch(side) {\n            case \"top\": return d - this.state.cubeTop;\n            case \"bottom\": return d - this.state.cubeBottom;\n            case \"left\": return d - this.state.cubeLeft;\n            case \"right\": return d - this.state.cubeRight;\n            case \"front\": return d - this.state.cubeFront;\n            case \"back\": return d - this.state.cubeBack;\n            default: return 0;\n        }\n    }\n      \n    getSerializedLogo(logos, i) {\n        if (i < logos.length) {\n            return logos[i];\n        }\n    }\n    isLogoCollision(logo) {\n\n        switch (logo) {\n            case this.state.cubeTopBackgroundUrl:\n            case this.state.cubeBottomBackgroundUrl:\n            case this.state.cubeBackBackgroundUrl:\n            case this.state.cubeFrontBackgroundUrl:\n            case this.state.cubeLeftBackgroundUrl:\n            case this.state.cubeRightBackgroundUrl:\n                return true;\n            default:\n                return false;\n        }\n\n    }\n    getRandomLogo(logos) {\n        var logo, i = 0;\n        do {\n            logo = logos[Math.floor(Math.random() * logos.length)];\n            i++;\n        } while (this.isLogoCollision(logo) && (i <= logos.length))\n        return logo;\n    }\n\n    \n    getRandomSide() {\n\n        const side = Math.floor(Math.random() * 6);\n        switch(side) {\n            case 0: return \"top\";\n            case 1: return \"bottom\";\n            case 2: return \"left\";\n            case 3: return \"right\";\n            case 4: return \"front\";\n            case 5: return \"back\";\n            default: return null;\n        }\n    \n    }\n    \n}\n\nexport default LogoCube;\n\nconst CubeSide = (props) => {\n\n    const clsId = \"d3-side \" + props.side + \" \" + props.classes;\n    const divId = \"cube-\" + props.side + \"-logo\";\n    const divStyle = {\n        backgroundImage: \"url('\" + props.url + \"')\"\n      }\n\n    return(\n        <React.Fragment >\n            <div key={divId}  \n                 className={clsId}>\n                <div>\n                    <div className=\"logo\" \n                        style={divStyle}>\n                    </div>\n                </div>\n            </div>\n        </React.Fragment>\n    );\n}"]},"metadata":{},"sourceType":"module"}