{"ast":null,"code":"import _classCallCheck from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */import React,{Component}from'react';import{wpGetFeaturedImage}from'../../shared/wpGetFeaturedImage';import'./styles.css';import Loading from'../Loading';var CubeSide=function CubeSide(props){var clsId=\"d3-side \"+props.side;var divId=\"cube-\"+props.side+\"-logo\";var divStyle={backgroundImage:\"url('\"+props.url+\"')\"};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:clsId},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{key:divId,className:\"logo\",style:divStyle}))));};var LogoCube=/*#__PURE__*/function(_Component){_inherits(LogoCube,_Component);var _super=_createSuper(LogoCube);function LogoCube(props){var _this;_classCallCheck(this,LogoCube);_this=_super.call(this,props);/*\n            Note: one ugly side effect of the randomness in choosing which side to update, and\n            the time at which to update is that, sometimes, the same panel gets chosen very quickly\n            which leads to jerky-looking behavior.\n\n            To prevent this we keep track of how long each logo has been on a given cube side.\n            the repaint() method will only repaint a side if that side has been in the same state \n            for at least X milliseconds.\n         */var d=new Date();d.setSeconds(d.getSeconds()-2);var logos=_this.props.logos.items.map(function(post,indx){return wpGetFeaturedImage(post,null);});_this.state={logos:logos,timeout:null,cubeTop:d,cubeBottom:d,cubeLeft:d,cubeRight:d,cubeFront:d,cubeBack:d,cubeTopBackgroundUrl:null,cubeBottomBackgroundUrl:null,cubeLeftBackgroundUrl:null,cubeRightBackgroundUrl:null,cubeFrontBackgroundUrl:null,cubeBackBackgroundUrl:null};_this.resetElapsedTime=_this.resetElapsedTime.bind(_assertThisInitialized(_this));_this.getElapsedTime=_this.getElapsedTime.bind(_assertThisInitialized(_this));_this.getBackgroundUrl=_this.getBackgroundUrl.bind(_assertThisInitialized(_this));_this.setBackgroundUrl=_this.setBackgroundUrl.bind(_assertThisInitialized(_this));_this.getRandomSide=_this.getRandomSide.bind(_assertThisInitialized(_this));_this.getRandomLogo=_this.getRandomLogo.bind(_assertThisInitialized(_this));_this.repaint=_this.repaint.bind(_assertThisInitialized(_this));return _this;}_createClass(LogoCube,[{key:\"componentDidMount\",value:function componentDidMount(){/*\n            Note: componentDidMount() gets called a half dozen times bc the Home component\n            which instantiates this component itself mounts and unmounts multiple times.\n\n            we therefore delay the first repaint for a while. however\n            we also have to keep track of the repaint() threads that we invoke so that \n            we can kill them in cases where the component mounts and then quickly unmounts.\n         */var self=this;if(!this.props.logos.isLoading){this.setBackgroundUrl(\"top\",this.getRandomLogo());this.setBackgroundUrl(\"bottom\",this.getRandomLogo());this.setBackgroundUrl(\"left\",this.getRandomLogo());this.setBackgroundUrl(\"right\",this.getRandomLogo());this.setBackgroundUrl(\"front\",this.getRandomLogo());this.setBackgroundUrl(\"back\",this.getRandomLogo());/*\n                kick off an infinite loop of repaint()\n             */var myTimeout=setTimeout(function(){self.repaint();},1000);}this.setState({timeout:myTimeout});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){/*\n            kill any pending repaint() invocation from componentDidMount().\n         */clearTimeout(this.state.timeout);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{id:\"logoprop\",className:\"d3-container\"},this.props.logos.isLoading?/*#__PURE__*/React.createElement(Loading,null):/*#__PURE__*/React.createElement(\"div\",{className:\"d3-cube\"},/*#__PURE__*/React.createElement(CubeSide,{side:\"top\",url:this.getBackgroundUrl(\"top\")}),/*#__PURE__*/React.createElement(CubeSide,{side:\"bottom\",url:this.getBackgroundUrl(\"bottom\")}),/*#__PURE__*/React.createElement(CubeSide,{side:\"front\",url:this.getBackgroundUrl(\"front\")}),/*#__PURE__*/React.createElement(CubeSide,{side:\"back\",url:this.getBackgroundUrl(\"back\")}),/*#__PURE__*/React.createElement(CubeSide,{side:\"right\",url:this.getBackgroundUrl(\"right\")}),/*#__PURE__*/React.createElement(CubeSide,{side:\"left\",url:this.getBackgroundUrl(\"left\")})));}},{key:\"repaint\",value:function repaint(){var self=this;setTimeout(function(){var side=self.getRandomSide();var logo=self.getRandomLogo();var elapsed=self.getElapsedTime(side);if(side!=null&&elapsed>3000){self.setBackgroundUrl(side,logo);}self.repaint();},1000*Math.random());}},{key:\"getBackgroundUrl\",value:function getBackgroundUrl(side){var retval;switch(side){case\"top\":retval=this.state.cubeTopBackgroundUrl;break;case\"bottom\":retval=this.state.cubeBottomBackgroundUrl;break;case\"left\":retval=this.state.cubeLeftBackgroundUrl;break;case\"right\":retval=this.state.cubeRightBackgroundUrl;break;case\"front\":retval=this.state.cubeFrontBackgroundUrl;break;case\"back\":retval=this.state.cubeBackBackgroundUrl;break;}return retval;}},{key:\"setBackgroundUrl\",value:function setBackgroundUrl(side,url){var _this2=this;var state;switch(side){case\"top\":state={cubeTopBackgroundUrl:url};break;case\"bottom\":state={cubeBottomBackgroundUrl:url};break;case\"left\":state={cubeLeftBackgroundUrl:url};break;case\"right\":state={cubeRightBackgroundUrl:url};break;case\"front\":state={cubeFrontBackgroundUrl:url};break;case\"back\":state={cubeBackBackgroundUrl:url};break;}this.setState(state,function(){_this2.resetElapsedTime(side);});}},{key:\"resetElapsedTime\",value:function resetElapsedTime(side){var d=new Date();var state;switch(side){case\"top\":state={cubeTop:d};break;case\"bottom\":state={cubeBottom:d};break;case\"left\":state={cubeLeft:d};break;case\"right\":state={cubeRight:d};break;case\"front\":state={cubeFront:d};break;case\"back\":state={cubeBack:d};break;}this.setState(state);}},{key:\"getElapsedTime\",value:function getElapsedTime(side){var d=new Date();switch(side){case\"top\":return d-this.state.cubeTop;case\"bottom\":return d-this.state.cubeBottom;case\"left\":return d-this.state.cubeLeft;case\"right\":return d-this.state.cubeRight;case\"front\":return d-this.state.cubeFront;case\"back\":return d-this.state.cubeBack;}}},{key:\"getRandomLogo\",value:function getRandomLogo(){/*\n            choose a random logo\n        */var logo=this.state.logos[Math.floor(Math.random()*this.state.logos.length)];/* \n          we don't want to see the same logo twice, so if we got a duplicate then\n          reshuffle.\n         */if(logo===this.state.cubeTopBackgroundUrl){return this.getRandomLogo();}if(logo===this.state.cubeBottomBackgroundUrl){return this.getRandomLogo();}if(logo===this.state.cubeBackBackgroundUrl){return this.getRandomLogo();}if(logo===this.state.cubeFrontBackgroundUrl){return this.getRandomLogo();}if(logo===this.state.cubeLeftBackgroundUrl){return this.getRandomLogo();}if(logo===this.state.cubeRightBackgroundUrl){return this.getRandomLogo();}return logo;}},{key:\"getRandomSide\",value:function getRandomSide(){var side=Math.floor(Math.random()*6);switch(side){case 0:return\"top\";case 1:return\"bottom\";case 2:return\"left\";case 3:return\"right\";case 4:return\"front\";case 5:return\"back\";}}}]);return LogoCube;}(Component);export default LogoCube;","map":{"version":3,"sources":["/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/src/components/logocube/Component.js"],"names":["React","Component","wpGetFeaturedImage","Loading","CubeSide","props","clsId","side","divId","divStyle","backgroundImage","url","LogoCube","d","Date","setSeconds","getSeconds","logos","items","map","post","indx","state","timeout","cubeTop","cubeBottom","cubeLeft","cubeRight","cubeFront","cubeBack","cubeTopBackgroundUrl","cubeBottomBackgroundUrl","cubeLeftBackgroundUrl","cubeRightBackgroundUrl","cubeFrontBackgroundUrl","cubeBackBackgroundUrl","resetElapsedTime","bind","getElapsedTime","getBackgroundUrl","setBackgroundUrl","getRandomSide","getRandomLogo","repaint","self","isLoading","myTimeout","setTimeout","setState","clearTimeout","logo","elapsed","Math","random","retval","floor","length"],"mappings":"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","sourcesContent":["/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */\nimport React, { Component } from 'react';\nimport { wpGetFeaturedImage } from '../../shared/wpGetFeaturedImage';\nimport './styles.css';\nimport Loading from '../Loading';\n\nconst CubeSide = (props) => {\n\n    const clsId = \"d3-side \" + props.side;\n    const divId = \"cube-\" + props.side + \"-logo\";\n    const divStyle = {\n        backgroundImage: \"url('\" + props.url + \"')\"\n      }\n\n    return(\n        <React.Fragment >\n            <div className={clsId}><div>\n                <div key={divId} \n                     className=\"logo\" \n                     style={divStyle}>\n                </div>\n            </div></div>\n        </React.Fragment>\n    );\n}\nclass LogoCube extends Component {\n\n    constructor(props) {\n        super(props);\n\n        /*\n            Note: one ugly side effect of the randomness in choosing which side to update, and\n            the time at which to update is that, sometimes, the same panel gets chosen very quickly\n            which leads to jerky-looking behavior.\n\n            To prevent this we keep track of how long each logo has been on a given cube side.\n            the repaint() method will only repaint a side if that side has been in the same state \n            for at least X milliseconds.\n         */\n        var d = new Date();\n        d.setSeconds(d.getSeconds() - 2);\n\n        const logos =  this.props.logos.items.map((post, indx) => {\n            return wpGetFeaturedImage(post, null);\n        });\n\n        this.state = {\n            logos: logos,\n            timeout: null,\n            cubeTop: d,\n            cubeBottom: d,\n            cubeLeft: d,\n            cubeRight: d,\n            cubeFront: d,\n            cubeBack: d,\n\n            cubeTopBackgroundUrl: null,\n            cubeBottomBackgroundUrl: null,\n            cubeLeftBackgroundUrl: null,\n            cubeRightBackgroundUrl: null,\n            cubeFrontBackgroundUrl: null,\n            cubeBackBackgroundUrl: null\n          };\n\n        this.resetElapsedTime = this.resetElapsedTime.bind(this);\n        this.getElapsedTime = this.getElapsedTime.bind(this);\n        this.getBackgroundUrl = this.getBackgroundUrl.bind(this);\n        this.setBackgroundUrl = this.setBackgroundUrl.bind(this);\n        this.getRandomSide = this.getRandomSide.bind(this);\n        this.getRandomLogo = this.getRandomLogo.bind(this);\n    \n        this.repaint = this.repaint.bind(this);\n        }\n\n\n\n    componentDidMount() {\n        /*\n            Note: componentDidMount() gets called a half dozen times bc the Home component\n            which instantiates this component itself mounts and unmounts multiple times.\n\n            we therefore delay the first repaint for a while. however\n            we also have to keep track of the repaint() threads that we invoke so that \n            we can kill them in cases where the component mounts and then quickly unmounts.\n         */\n        var self = this;\n        if (!this.props.logos.isLoading) {\n\n            this.setBackgroundUrl(\"top\", this.getRandomLogo());                \n            this.setBackgroundUrl(\"bottom\", this.getRandomLogo());                \n            this.setBackgroundUrl(\"left\", this.getRandomLogo());                \n            this.setBackgroundUrl(\"right\", this.getRandomLogo());                \n            this.setBackgroundUrl(\"front\", this.getRandomLogo());                \n            this.setBackgroundUrl(\"back\", this.getRandomLogo());                \n\n            /*\n                kick off an infinite loop of repaint()\n             */\n            var myTimeout = setTimeout(function() {\n                self.repaint();\n            }, 1000);    \n        }\n        this.setState({timeout: myTimeout});\n\n    }\n\n    componentWillUnmount() {\n        /*\n            kill any pending repaint() invocation from componentDidMount().\n         */\n        clearTimeout(this.state.timeout);        \n    }\n    \n    render() {\n\n        return(\n            <div id=\"logoprop\" className=\"d3-container\">\n            {this.props.logos.isLoading ? (\n                <Loading />\n              ) : (\n                <div className=\"d3-cube\">\n                    <CubeSide side={\"top\"} url={this.getBackgroundUrl(\"top\")} />\n                    <CubeSide side={\"bottom\"} url={this.getBackgroundUrl(\"bottom\")} />\n                    <CubeSide side={\"front\"} url={this.getBackgroundUrl(\"front\")} />\n                    <CubeSide side={\"back\"} url={this.getBackgroundUrl(\"back\")} />\n                    <CubeSide side={\"right\"} url={this.getBackgroundUrl(\"right\")} />\n                    <CubeSide side={\"left\"} url={this.getBackgroundUrl(\"left\")} />\n                </div>\n              )}\n            </div>\n        );\n    }\n\n    repaint() {\n        var self = this;\n        \n        setTimeout(function() {\n            const side = self.getRandomSide();\n            const logo = self.getRandomLogo();\n            const elapsed = self.getElapsedTime(side);\n            if (side != null && elapsed > 3000) {\n                self.setBackgroundUrl(side, logo);\n            }\n            self.repaint();\n        }, 1000 * Math.random());   \n      \n    }\n\n\n    getBackgroundUrl(side) {\n        let retval;\n        switch(side) {\n            case \"top\": retval = this.state.cubeTopBackgroundUrl; break;\n            case \"bottom\": retval =  this.state.cubeBottomBackgroundUrl; break;\n            case \"left\": retval =  this.state.cubeLeftBackgroundUrl; break;\n            case \"right\": retval =  this.state.cubeRightBackgroundUrl; break;\n            case \"front\": retval =  this.state.cubeFrontBackgroundUrl; break;\n            case \"back\": retval =  this.state.cubeBackBackgroundUrl; break;\n        }\n        return retval;\n    }\n\n    setBackgroundUrl(side, url) {\n\n        let state;\n        switch(side) {\n            case \"top\": state = {cubeTopBackgroundUrl: url}; break;\n            case \"bottom\": state = {cubeBottomBackgroundUrl: url}; break;\n            case \"left\": state = {cubeLeftBackgroundUrl: url}; break;\n            case \"right\": state = {cubeRightBackgroundUrl: url}; break;\n            case \"front\": state = {cubeFrontBackgroundUrl: url}; break;\n            case \"back\": state = {cubeBackBackgroundUrl: url}; break;\n        }\n        this.setState(state, () => {\n            this.resetElapsedTime(side);\n        });\n\n    }\n\n    resetElapsedTime(side) {\n        const d = new Date();\n        let state;\n        switch(side) {\n            case \"top\": state = {cubeTop: d}; break;\n            case \"bottom\": state = {cubeBottom: d}; break;\n            case \"left\":state = {cubeLeft: d}; break;\n            case \"right\": state = {cubeRight: d}; break;\n            case \"front\": state = {cubeFront: d}; break;\n            case \"back\": state = {cubeBack: d}; break;\n        }\n        this.setState(state);\n\n    }\n\n    getElapsedTime(side) {\n        const d = new Date();\n        switch(side) {\n            case \"top\": return d - this.state.cubeTop;\n            case \"bottom\": return d - this.state.cubeBottom;\n            case \"left\": return d - this.state.cubeLeft;\n            case \"right\": return d - this.state.cubeRight;\n            case \"front\": return d - this.state.cubeFront;\n            case \"back\": return d - this.state.cubeBack;\n        }\n    }\n      \n    getRandomLogo() {\n\n        /*\n            choose a random logo\n        */\n        const logo = this.state.logos[Math.floor(Math.random() * this.state.logos.length)];\n\n        /* \n          we don't want to see the same logo twice, so if we got a duplicate then\n          reshuffle.\n         */\n        if (logo === this.state.cubeTopBackgroundUrl) {return this.getRandomLogo()}\n        if (logo === this.state.cubeBottomBackgroundUrl) {return this.getRandomLogo()}\n        if (logo === this.state.cubeBackBackgroundUrl) {return this.getRandomLogo()}\n        if (logo === this.state.cubeFrontBackgroundUrl) {return this.getRandomLogo()}\n        if (logo === this.state.cubeLeftBackgroundUrl) {return this.getRandomLogo()}\n        if (logo === this.state.cubeRightBackgroundUrl) {return this.getRandomLogo()}\n\n        return logo;\n    }\n\n    \n    getRandomSide() {\n\n        const side = Math.floor(Math.random() * 6);\n        switch(side) {\n            case 0: return \"top\";\n            case 1: return \"bottom\";\n            case 2: return \"left\";\n            case 3: return \"right\";\n            case 4: return \"front\";\n            case 5: return \"back\";\n        }\n    \n    }\n    \n}\n\nexport default LogoCube;\n"]},"metadata":{},"sourceType":"module"}