{"ast":null,"code":"var _jsxFileName = \"/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/src/components/logocube/Component.js\";\n\n/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */\nimport React, { Component } from 'react';\nimport { selectAll, select } from \"d3-selection\";\nimport transition from 'd3-transition';\nimport { wpGetFeaturedImage } from '../../shared/wpGetFeaturedImage';\nimport './styles.css';\nimport { nominalTypeHack } from 'prop-types';\nimport Loading from '../Loading';\n\nconst LogoDiv = props => {\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d3-side {props.side}\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 17,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 17,\n      columnNumber: 51\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"cube-{props.side}\",\n    className: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 17\n    }\n  }))));\n};\n\nclass LogoCube extends Component {\n  constructor(props) {\n    super(props);\n    /*\n        Note: one ugly side effect of the randomness in choosing which side to update, and\n        the time at which to update is that, sometimes, the same panel gets chosen very quickly\n        which leads to jerky-looking behavior.\n         To prevent this we keep track of how long each logo has been on a given cube side.\n        the repaint() method will only repaint a side if that side has in-state for at least \n        X milliseconds.\n     */\n\n    var d = new Date();\n    d.setSeconds(d.getSeconds() - 2);\n    this.state = {\n      timeout: null,\n      cubeTop: d,\n      cubeBottom: d,\n      cubeLeft: d,\n      cubeRight: d,\n      cubeFront: d,\n      cubeBack: d,\n      cubeTopBackgroundUrl: null,\n      cubeBottomBackgroundUrl: null,\n      cubeLeftBackgroundUrl: null,\n      cubeRightBackgroundUrl: null,\n      cubeFrontBackgroundUrl: null,\n      cubeBackBackgroundUrl: null\n    };\n    this.resetElapsedTime = this.resetElapsedTime.bind(this);\n    this.getElapsedTime = this.getElapsedTime.bind(this);\n    this.getBackgroundUrl = this.getBackgroundUrl.bind(this);\n    this.setBackgroundUrl = this.setBackgroundUrl.bind(this);\n    this.logos = this.logos.bind(this);\n    this.shuffleArray = this.shuffleArray.bind(this);\n    this.repaint = this.repaint.bind(this);\n  }\n\n  getBackgroundUrl(side) {\n    switch (side) {\n      case \"cube-top\":\n        return this.state.cubeTopBackgroundUrl;\n\n      case \"cube-bottom\":\n        return this.state.cubeBottomBackgroundUrl;\n\n      case \"cube-left\":\n        return this.state.cubeLeftBackgroundUrl;\n\n      case \"cube-right\":\n        return this.state.cubeRightBackgroundUrl;\n\n      case \"cube-front\":\n        return this.state.cubeFrontBackgroundUrl;\n\n      case \"cube-back\":\n        return this.state.cubeBackBackgroundUrl;\n    }\n  }\n\n  setBackgroundUrl(side, url) {\n    switch (side) {\n      case \"cube-top\":\n        this.setState({\n          cubeTopBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-bottom\":\n        this.setState({\n          cubeBottomBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-left\":\n        this.setState({\n          cubeLeftBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-right\":\n        this.setState({\n          cubeRightBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-front\":\n        this.setState({\n          cubeFrontBackgroundUrl: url\n        });\n        break;\n\n      case \"cube-back\":\n        this.setState({\n          cubeBackBackgroundUrl: url\n        });\n        break;\n    }\n  }\n\n  componentDidMount() {\n    /*\n        Note: componentDidMount() gets called a half dozen times bc the Home component\n        which instantiates this component itself mounts and unmounts multiple times.\n         we therefore have to keep track of any repaint() threads that we invoke so that \n        we can kill them if necessary.\n     */\n    var self = this;\n\n    if (!this.props.logos.isLoading) {\n      var myTimeout = setTimeout(function () {\n        self.repaint();\n      }, 1000);\n    }\n\n    this.setState({\n      timeout: myTimeout\n    });\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.state.timeout);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"logoprop\",\n      className: \"d3-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 13\n      }\n    }, this.props.logos.isLoading ? /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-cube\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-side top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 50\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cube-top\",\n      className: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(LogoDiv, {\n      side: bottom,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-side front\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 52\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cube-front\",\n      className: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-side back\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 51\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cube-back\",\n      className: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-side right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 52\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cube-right\",\n      className: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d3-side left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 51\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cube-left\",\n      className: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 25\n      }\n    })))));\n  }\n\n  resetElapsedTime(side) {\n    const d = new Date();\n\n    switch (side) {\n      case \"cube-top\":\n        this.setState({\n          cubeTop: d\n        });\n        break;\n\n      case \"cube-bottom\":\n        this.setState({\n          cubeBottom: d\n        });\n        break;\n\n      case \"cube-left\":\n        this.setState({\n          cubeLeft: d\n        });\n        break;\n\n      case \"cube-right\":\n        this.setState({\n          cubeRight: d\n        });\n        break;\n\n      case \"cube-front\":\n        this.setState({\n          cubeFront: d\n        });\n        break;\n\n      case \"cube-back\":\n        this.setState({\n          cubeBack: d\n        });\n        break;\n    }\n  }\n\n  getElapsedTime(side) {\n    const d = new Date();\n\n    switch (side) {\n      case \"cube-top\":\n        return d - this.state.cubeTop;\n\n      case \"cube-bottom\":\n        return d - this.state.cubeBottom;\n\n      case \"cube-left\":\n        return d - this.state.cubeLeft;\n\n      case \"cube-right\":\n        return d - this.state.cubeRight;\n\n      case \"cube-front\":\n        return d - this.state.cubeFront;\n\n      case \"cube-back\":\n        return d - this.state.cubeBack;\n    }\n  }\n\n  logos() {\n    var self = this;\n    return self.props.logos.items;\n  }\n\n  shuffleArray(array) {\n    let i = array.length - 1;\n\n    for (; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      const temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n    }\n\n    return array;\n  }\n\n  repaint() {\n    var self = this;\n\n    if (self.props.logos.isLoading || self.props.logos.items.length === 0) {\n      return false;\n    }\n\n    function random_logo(logos) {\n      return logos[Math.floor(Math.random() * logos.length)];\n    }\n\n    const logos = this.props.logos.items.map((post, indx) => {\n      return wpGetFeaturedImage(post, null);\n    });\n    var idx = Math.floor(Math.random() * selectAll(\".logo\").size());\n    selectAll(\".logo\").filter(function (d, i) {\n      return i === idx;\n    }).each(function () {\n      var side = select(this);\n      var sideId = this.id;\n      setTimeout(function () {\n        side.transition().duration(500).style(\"opacity\", 0);\n\n        if (Math.random() < 0.10) {\n          side.style(\"background-image\", \"none\");\n        } else {\n          if (self.getElapsedTime(sideId) > 5000) {\n            side.style(\"background-image\", \"url('\" + random_logo(logos) + \"')\");\n            self.resetElapsedTime(sideId);\n          }\n        }\n\n        side.transition().duration(500).style(\"opacity\", 1);\n        self.repaint();\n      }, 1000 * Math.random());\n    });\n  }\n\n}\n\nexport default LogoCube;","map":{"version":3,"sources":["/Users/mcdaniel/github/lpm0073/lawrencemcdaniel.com/site/src/components/logocube/Component.js"],"names":["React","Component","selectAll","select","transition","wpGetFeaturedImage","nominalTypeHack","Loading","LogoDiv","props","LogoCube","constructor","d","Date","setSeconds","getSeconds","state","timeout","cubeTop","cubeBottom","cubeLeft","cubeRight","cubeFront","cubeBack","cubeTopBackgroundUrl","cubeBottomBackgroundUrl","cubeLeftBackgroundUrl","cubeRightBackgroundUrl","cubeFrontBackgroundUrl","cubeBackBackgroundUrl","resetElapsedTime","bind","getElapsedTime","getBackgroundUrl","setBackgroundUrl","logos","shuffleArray","repaint","side","url","setState","componentDidMount","self","isLoading","myTimeout","setTimeout","componentWillUnmount","clearTimeout","render","bottom","items","array","i","length","j","Math","floor","random","temp","random_logo","map","post","indx","idx","size","filter","each","sideId","id","duration","style"],"mappings":"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","sourcesContent":["/*\n    https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\n */\nimport React, { Component } from 'react';\nimport { selectAll, select } from \"d3-selection\";\nimport transition from 'd3-transition';\nimport { wpGetFeaturedImage } from '../../shared/wpGetFeaturedImage';\nimport './styles.css';\nimport { nominalTypeHack } from 'prop-types';\nimport Loading from '../Loading';\n\nconst LogoDiv = (props) => {\n\n\n    return(\n        <React.Fragment>\n            <div className=\"d3-side {props.side}\"><div>\n                <div id=\"cube-{props.side}\" className=\"logo\"></div>\n            </div></div>\n        </React.Fragment>\n\n    );\n}\nclass LogoCube extends Component {\n\n    constructor(props) {\n        super(props);\n\n        /*\n            Note: one ugly side effect of the randomness in choosing which side to update, and\n            the time at which to update is that, sometimes, the same panel gets chosen very quickly\n            which leads to jerky-looking behavior.\n\n            To prevent this we keep track of how long each logo has been on a given cube side.\n            the repaint() method will only repaint a side if that side has in-state for at least \n            X milliseconds.\n         */\n        var d = new Date();\n        d.setSeconds(d.getSeconds() - 2);\n\n        this.state = {\n            timeout: null,\n            cubeTop: d,\n            cubeBottom: d,\n            cubeLeft: d,\n            cubeRight: d,\n            cubeFront: d,\n            cubeBack: d,\n\n            cubeTopBackgroundUrl: null,\n            cubeBottomBackgroundUrl: null,\n            cubeLeftBackgroundUrl: null,\n            cubeRightBackgroundUrl: null,\n            cubeFrontBackgroundUrl: null,\n            cubeBackBackgroundUrl: null\n          };\n\n        this.resetElapsedTime = this.resetElapsedTime.bind(this);\n        this.getElapsedTime = this.getElapsedTime.bind(this);\n        this.getBackgroundUrl = this.getBackgroundUrl.bind(this);\n        this.setBackgroundUrl = this.setBackgroundUrl.bind(this);\n    \n        this.logos = this.logos.bind(this);\n        this.shuffleArray = this.shuffleArray.bind(this);\n        this.repaint = this.repaint.bind(this);\n        }\n\n    getBackgroundUrl(side) {\n        switch(side) {\n            case \"cube-top\": return this.state.cubeTopBackgroundUrl;\n            case \"cube-bottom\": return this.state.cubeBottomBackgroundUrl;\n            case \"cube-left\": return this.state.cubeLeftBackgroundUrl;\n            case \"cube-right\": return this.state.cubeRightBackgroundUrl;\n            case \"cube-front\": return this.state.cubeFrontBackgroundUrl;\n            case \"cube-back\": return this.state.cubeBackBackgroundUrl;\n        }\n\n    }\n    setBackgroundUrl(side, url) {\n        switch(side) {\n            case \"cube-top\":\n                this.setState({cubeTopBackgroundUrl: url});\n                break;\n            case \"cube-bottom\":\n                this.setState({cubeBottomBackgroundUrl: url});\n                break;\n            case \"cube-left\":\n                this.setState({cubeLeftBackgroundUrl: url});\n                break;\n            case \"cube-right\":\n                this.setState({cubeRightBackgroundUrl: url});\n                break;\n            case \"cube-front\":\n                this.setState({cubeFrontBackgroundUrl: url});\n                break;\n            case \"cube-back\":\n                this.setState({cubeBackBackgroundUrl: url});\n                break;\n        }        \n\n    }\n\n    componentDidMount() {\n        /*\n            Note: componentDidMount() gets called a half dozen times bc the Home component\n            which instantiates this component itself mounts and unmounts multiple times.\n\n            we therefore have to keep track of any repaint() threads that we invoke so that \n            we can kill them if necessary.\n         */\n        var self = this;\n        if (!this.props.logos.isLoading) {\n            var myTimeout = setTimeout(function() {\n                self.repaint();\n            }, 1000);    \n        }\n        this.setState({timeout: myTimeout});\n\n    }\n\n    componentWillUnmount() {\n        clearTimeout(this.state.timeout);        \n    }\n    \n    render() {\n\n        return(\n            <div id=\"logoprop\" className=\"d3-container\">\n            {this.props.logos.isLoading ? (\n                <Loading />\n              ) : (\n                <div className=\"d3-cube\">\n                    <div className=\"d3-side top\"><div>\n                        <div id=\"cube-top\" className=\"logo\"></div>\n                    </div></div>\n                    <LogoDiv side={bottom}/>\n                    <div className=\"d3-side front\"><div>\n                        <div id=\"cube-front\" className=\"logo\"></div>\n                    </div></div>\n                    <div className=\"d3-side back\"><div>\n                        <div id=\"cube-back\" className=\"logo\"></div>\n                    </div></div>\n                    <div className=\"d3-side right\"><div>\n                        <div id=\"cube-right\" className=\"logo\"></div>\n                    </div></div>\n                    <div className=\"d3-side left\"><div>\n                        <div id=\"cube-left\" className=\"logo\"></div>\n                    </div></div>\n                </div>\n              )}\n            </div>\n        );\n    }\n\n    resetElapsedTime(side) {\n        const d = new Date();\n        switch(side) {\n            case \"cube-top\":\n                this.setState({cubeTop: d});\n                break;\n            case \"cube-bottom\":\n                this.setState({cubeBottom: d});\n                break;\n            case \"cube-left\":\n                this.setState({cubeLeft: d});\n                break;\n            case \"cube-right\":\n                this.setState({cubeRight: d});\n                break;\n            case \"cube-front\":\n                this.setState({cubeFront: d});\n                break;\n            case \"cube-back\":\n                this.setState({cubeBack: d});\n                break;\n        }        \n    }\n\n    getElapsedTime(side) {\n        const d = new Date();\n        switch(side) {\n            case \"cube-top\": return d - this.state.cubeTop;\n            case \"cube-bottom\": return d - this.state.cubeBottom;\n            case \"cube-left\": return d - this.state.cubeLeft;\n            case \"cube-right\": return d - this.state.cubeRight;\n            case \"cube-front\": return d - this.state.cubeFront;\n            case \"cube-back\": return d - this.state.cubeBack;\n        }\n    }\n\n    logos() {\n        var self = this;\n        return self.props.logos.items;\n    }\n\n    shuffleArray(array) {\n        let i = array.length - 1;\n        for (; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            const temp = array[i];\n            array[i] = array[j];\n            array[j] = temp;\n        }\n        return array;\n    }\n\n    repaint() {\n        var self = this;\n        if (self.props.logos.isLoading || self.props.logos.items.length === 0) {\n            return false;\n        }\n\n        function random_logo(logos) {\n            return logos[Math.floor(Math.random() * logos.length)];\n        }\n    \n        const logos =  this.props.logos.items.map((post, indx) => {\n            return wpGetFeaturedImage(post, null);\n        });\n              \n        var idx = Math.floor(Math.random() * selectAll(\".logo\").size());\n        selectAll(\".logo\")\n          .filter(function(d, i) {return i === idx})\n          .each(function() {\n      \n            var side = select(this);\n            var sideId = this.id;\n\n            setTimeout(function() {\n               side.transition()\n               .duration(500)\n               .style(\"opacity\", 0);\n               \n               if (Math.random() < 0.10) {\n                   side.style(\"background-image\", \"none\");\n               } else {\n                   if (self.getElapsedTime(sideId) > 5000) {\n                        side.style(\"background-image\", \"url('\" + random_logo(logos) + \"')\");\n                        self.resetElapsedTime(sideId);\n                   }\n               }\n       \n               side.transition()\n                   .duration(500)\n                   .style(\"opacity\", 1);\n   \n                self.repaint();\n              }, 1000 * Math.random());   \n      \n      \n          });\n      \n    }\n      \n}\n\nexport default LogoCube;\n"]},"metadata":{},"sourceType":"module"}